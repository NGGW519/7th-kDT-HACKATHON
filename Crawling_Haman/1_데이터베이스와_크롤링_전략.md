
# 함안군 데이터베이스 구성 및 웹 크롤링 전략

## 1. 데이터베이스 및 테이블 구성 방안

다양한 종류의 데이터를 효율적으로 관리하고 확장성을 높이기 위해, 유사한 성격의 데이터를 통합하여 관리하는 것을 목표로 합니다.

### 1.1. 제안 스키마 구조

*   **`locations` 테이블**: 함안군 내의 모든 장소 관련 정보를 통합 관리합니다.
    *   **설명**: 맛집, 카페, 병원, 경로당, 주유소 등 모든 장소 정보를 하나의 테이블에 저장하고 `category` 컬럼으로 유형을 구분합니다. 이렇게 하면 새로운 유형의 장소가 추가되더라도 테이블 구조 변경 없이 유연하게 대응할 수 있습니다.
    *   **컬럼 예시**:
        *   `id` (PK, Auto-increment): 고유 식별자
        *   `name` (VARCHAR): 장소 이름 (예: 함안병원)
        *   `category` (VARCHAR): 장소 유형 (예: '병원', '맛집', '카페', '경로당', '주유소')
        *   `address` (VARCHAR): 주소
        *   `latitude` (DECIMAL): 위도
        *   `longitude` (DECIMAL): 경도
        *   `phone` (VARCHAR): 전화번호
        *   `description` (TEXT): 상세 설명 (크롤링으로 수집)
        *   `opening_hours` (VARCHAR): 영업시간 (크롤링으로 수집)
        *   `homepage_url` (VARCHAR): 공식 홈페이지 주소
        *   `source` (VARCHAR): 데이터 출처 (예: '함안군청', '네이버지도')
        *   `created_at` (DATETIME): 데이터 생성일

*   **`culture` 테이블**: 함안군의 인물, 전설 등 문화/역사 정보를 관리합니다.
    *   **설명**: '인물'과 '전설' 데이터는 장소와는 성격이 다르므로 별도의 테이블로 분리하여 관리합니다.
    *   **컬럼 예시**:
        *   `id` (PK, Auto-increment): 고유 식별자
        *   `title` (VARCHAR): 인물 이름 또는 전설 제목
        *   `category` (VARCHAR): 유형 ('인물', '전설')
        *   `story` (TEXT): 상세 내용 (인물 설명, 전설 이야기)
        *   `related_location_id` (FK, `locations.id`): 관련 장소 ID (해당 인물/전설과 관련된 장소가 있을 경우)
        *   `source` (VARCHAR): 데이터 출처
        *   `created_at` (DATETIME): 데이터 생성일

*   **`reviews` 테이블**: 장소에 대한 사용자 리뷰 정보를 관리합니다.
    *   **설명**: 웹 크롤링을 통해 수집한 리뷰 데이터를 저장합니다. `locations` 테이블과 1:N 관계로 연결됩니다.
    *   **컬럼 예시**:
        *   `id` (PK, Auto-increment): 고유 식별자
        *   `location_id` (FK, `locations.id`): `locations` 테이블의 장소 ID
        *   `rating` (DECIMAL): 평점
        *   `content` (TEXT): 리뷰 내용
        *   `author` (VARCHAR): 작성자
        *   `source` (VARCHAR): 리뷰 출처 (예: '카카오맵', '네이버지도')
        *   `created_at` (DATETIME): 리뷰 작성일

### 1.2. 초기 데이터 적재 방안

1.  제공된 모든 CSV 파일(`경상남도_함안군_*`)을 파싱합니다.
2.  파일 이름이나 내용에 따라 `category`를 지정합니다. (예: `맛집리스트.csv` -> '맛집', `병의원정보.csv` -> '병원')
3.  각 파일의 데이터를 위에서 제안한 테이블 구조에 맞게 정제하여 `locations`와 `culture` 테이블에 각각 INSERT 합니다.
4.  주소 데이터를 기반으로 지오코딩(Geocoding)을 수행하여 위도/경도(`latitude`, `longitude`) 값을 채워 넣습니다.

## 2. 웹 크롤링 및 파싱 전략

신뢰도 높은 공식 데이터를 기반으로, 사용자에게 유용한 최신 정보를 보강하는 방향으로 전략을 수립합니다.

### 2.1. 크롤링 대상 및 우선순위

1.  **1순위: 함안군 공식 웹사이트**
    *   **대상**: `사이트맵.csv` 파일에 있는 모든 링크.
    *   **전략**: 사이트맵을 기반으로 웹사이트의 전체 구조를 파악하고, 각 페이지를 크롤링하여 `locations` 및 `culture` 테이블의 `description` 등 상세 정보를 업데이트합니다. 공공데이터이므로 정보의 신뢰도가 가장 높습니다.

2.  **2순위: 네이버/카카오 지도 (API 또는 크롤링)**
    *   **대상**: `locations` 테이블에 있는 모든 장소.
    *   **전략**:
        *   DB에 저장된 장소 이름과 주소를 이용해 네이버/카카오 지도에서 검색합니다.
        *   검색 결과에서 **영업시간, 평점, 방문자 리뷰, 메뉴, 관련 이미지** 등 추가 정보를 수집합니다.
        *   수집한 정보는 `locations` 테이블을 업데이트하고, `reviews` 테이블에 신규 리뷰를 저장합니다.
        *   이를 통해 사용자들이 장소를 선택하는 데 실질적인 도움이 되는 정보를 제공할 수 있습니다.

3.  **3순위: 관광 정보 사이트 및 블로그**
    *   **대상**: 함안군 관련 주요 관광지, 맛집.
    *   **전략**: '함안 여행', '함안 맛집' 등의 키워드로 검색하여 나오는 블로그나 여행 정보 사이트의 콘텐츠를 수집합니다. 생생한 후기나 숨겨진 명소를 발굴하여 `locations` 테이블의 `description`을 보강하거나 신규 장소로 추가할 수 있습니다. 단, 정보의 신뢰도가 상대적으로 낮으므로 교차 검증이 필요합니다.

### 2.2. 파싱 및 데이터 정제 기준

*   **주소 정제**: 크롤링한 주소 데이터는 '도로명 주소' 형식으로 통일하고, 불필요한 문자(예: '상세주소: ')를 제거하여 표준화합니다.
*   **중복 제거**: `name`과 `address`를 조합하여 고유한 장소인지 판별하고, 중복 데이터가 쌓이지 않도록 관리합니다.
*   **정보 추출**: 정규표현식(Regex)과 CSS Selector를 활용하여 HTML 문서에서 원하는 정보(전화번호, 영업시간 등)를 정확하게 추출합니다.
*   **주기적인 업데이트**: 크롤링 프로세스를 자동화하여 주기적으로(예: 월 1회) 실행함으로써, 변경된 정보(폐업, 이전 등)를 최신 상태로 유지합니다.
